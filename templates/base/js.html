<script   src="https://code.jquery.com/jquery-3.3.1.min.js"
          integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
          crossorigin="anonymous">
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous">
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous">
</script>

<script type="text/javascript">
   $(document).ready(()=> {

       var productAddForm = $(".product-add-form")
       productAddForm.submit(function (event) {
           event.preventDefault()
           let form = $(this)
           let endPoint = form.attr("data-endpoint")
           let method = form.attr("method")
           let formData = form.serialize()

           $.ajax({
               url: endPoint,
               method:method,
               data:formData,

               success: function(data){
                   console.log('success')
                   console.log(data)
                   var submitSpan = form.find('.submit-span')
                   if (data.added){
                       submitSpan.html("In Cart <button type='submit' class=\"btn btn-danger\">Remove?</button>")
                   }else{
                       submitSpan.html("<button type='submit' class=\"btn btn-success\">Add To Cart</button>")
                   }
                   var count = $('.navbar-cart-count')
                   count.text(data.count)

                   var path = window.location.href

                   if(path.indexOf('cart') != -1){
                       updateCart()
                   }
               },
               error:function(err){
                   console.log("error")
                   console.log(err)
               }
           })

       })

       function updateCart(){
            var cartTable =$(".cart-table")
            var cartBody = cartTable.find(".cart-body")
            cartBody.html('<h1>Changed</h1>')

           var updateCartUrl

       }



   });

</script>